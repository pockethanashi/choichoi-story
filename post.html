<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°å™ºæŠ•ç¨¿</title>
  <link rel="stylesheet" href="styles/post.css">
  <link rel="stylesheet" href="styles/common.css">
  <link href="https://fonts.googleapis.com/css2?family=Kaisei+HarunoUmi&display=swap" rel="stylesheet">
</head>
<body>

  <!-- ğŸ”¹ å…±é€šãƒ˜ãƒƒãƒ€ãƒ¼ -->
  <header>
    <div class="main-header">
      <div class="header-main">
        <img src="images/logo.png" alt="ãƒ­ã‚´" class="logo">
        <div class="title-group">
          <h1 class="site-title">ã¡ã‚‡ã„Choiceã‚¹ãƒˆãƒ¼ãƒªãƒ¼</h1>
          <p class="site-subtitle">ã‚¢ãƒ—ãƒ‡ã™ã‚‹å°è©±</p>
        </div>
      </div>
    </div>
    <nav class="sub-header">
      <a href="index.html">ãƒˆãƒƒãƒ—</a>
      <a href="post.html">æŠ•ç¨¿</a>
      <a href="concept.html">ã“ã®ã‚µã‚¤ãƒˆã«ã¤ã„ã¦</a>
    </nav>
  </header>

  <main>
    <form id="post-form">
      <label for="title">ã‚¿ã‚¤ãƒˆãƒ«:</label>
      <input type="text" id="title" name="title" required>

      <label for="body">æœ¬æ–‡:</label>
      <textarea id="body" name="body" rows="6" required></textarea>

      <label for="genre">ã‚¸ãƒ£ãƒ³ãƒ«:</label>
      <select id="genre" name="genre" required>
        <option value="æ—¥å¸¸">æ—¥å¸¸</option>
        <option value="SF">SF</option>
        <option value="ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼">ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼</option>
        <option value="ãƒ›ãƒ©ãƒ¼">ãƒ›ãƒ©ãƒ¼</option>
        <option value="ã‚³ãƒ¡ãƒ‡ã‚£">ã‚³ãƒ¡ãƒ‡ã‚£</option>
      </select>

      <label for="author">ä½œè€…å:</label>
      <input type="text" id="author" name="author" required>

      <label for="profile">è‡ªå·±ç´¹ä»‹:</label>
      <textarea id="profile" name="profile" rows="3"></textarea>

      <label for="version">ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç•ªå·:</label>
      <input type="text" id="version" name="version">

      <label for="updateDate">æ›´æ–°æ—¥:</label>
      <input type="date" id="updateDate" name="updateDate">

      <label for="originalId">ã‚ªãƒªã‚¸ãƒŠãƒ«ID:</label>
      <input type="text" id="originalId" name="originalId" placeholder="æ–°è¦ä½œæˆãªã‚‰ç©ºã§OK">

      <label for="updateMemo">æ›´æ–°ãƒ¡ãƒ¢:</label><br>
      <textarea id="updateMemo" name="updateMemo" rows="3" placeholder="å¤‰æ›´å†…å®¹ã®ç°¡å˜ãªèª¬æ˜"></textarea>

      <input type="hidden" id="parentId" name="parentId">

      <button type="button" id="confirm-btn">ç¢ºèªç”»é¢ã¸</button>
    </form>
  </main>

  <script>
    // URLã®ã‚¯ã‚¨ãƒªã‹ã‚‰è¦ªIDã‚’å–å¾—ã—ã¦hiddenãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«è¨­å®š
    const urlParams = new URLSearchParams(window.location.search);
    const parentId = urlParams.get("parent");
    if (parentId) {
      document.getElementById("parentId").value = parentId;

      const originalInput = document.getElementById("originalId");
      if (originalInput && !originalInput.value) {
        originalInput.value = parentId;
      }
    }

    // ã€Œç¢ºèªç”»é¢ã¸ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ãŸã¨ãã®å‡¦ç†
    document.getElementById("confirm-btn").addEventListener("click", function () {
      const title = document.getElementById("title").value.trim();
      const body = document.getElementById("body").value.trim();
      const genre = document.getElementById("genre").value;
      const author = document.getElementById("author").value.trim();
      const profile = document.getElementById("profile").value.trim();
      const version = document.getElementById("version").value.trim();
      const updateDate = document.getElementById("updateDate").value;
      const originalId = document.getElementById("originalId").value.trim();
      const updateMemo = document.getElementById("updateMemo").value.trim();

      const parentIdFromForm = document.getElementById("parentId").value;

      if (!title || !body || !author) {
        alert("ã‚¿ã‚¤ãƒˆãƒ«ã€æœ¬æ–‡ã€ä½œè€…åã¯å¿…é ˆã§ã™ã€‚");
        return;
      }

      const params = new URLSearchParams({
        title,
        body,
        genre,
        author,
        profile,
        version,
        updateDate,
        originalId,
        updateMemo,
        parentId: parentIdFromForm
      });

      window.location.href = `confirm.html?${params.toString()}`;
    });
  </script>

</body>
</html>
